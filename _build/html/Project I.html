
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Project I &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Project I';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Project II" href="Project%20II.html" />
    <link rel="prev" title="Welcome to My Jupyter Book" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to My Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Project I</a></li>
<li class="toctree-l1"><a class="reference internal" href="Project%20II.html">Project II</a></li>
<li class="toctree-l1"><a class="reference internal" href="Project%20III.html">Project III</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FProject I.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Project I.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Project I</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting-multivariate"><strong>Forecasting Multivariate</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prediksi-kebutuhan-energi-panel-surya">Prediksi Kebutuhan Energi Panel Surya</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pendahuluan">Pendahuluan</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang">Latar Belakang</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rumusan-masalah">Rumusan Masalah</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan">Tujuan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bussines-understanding">Bussines Understanding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">Data Understanding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#library-yang-digunakan">Library yang digunakan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#membaca-data">Membaca data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menggabungkan-data">Menggabungkan data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">Eksplorasi Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outlier">Outlier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-value">Missing Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#target">Target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-decomposition">Time series decomposition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pengaruh-cuaca">Pengaruh Cuaca</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model">Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi">Evaluasi</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="project-i">
<h1>Project I<a class="headerlink" href="#project-i" title="Link to this heading">#</a></h1>
<section id="forecasting-multivariate">
<h2><strong>Forecasting Multivariate</strong><a class="headerlink" href="#forecasting-multivariate" title="Link to this heading">#</a></h2>
</section>
<section id="prediksi-kebutuhan-energi-panel-surya">
<h2>Prediksi Kebutuhan Energi Panel Surya<a class="headerlink" href="#prediksi-kebutuhan-energi-panel-surya" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Nama : Zulfa Lailatul Muâ€™achirin</p></li>
<li><p>Nim : 220411100147</p></li>
<li><p>Matkul : PSD D</p></li>
</ul>
</section>
<section id="pendahuluan">
<h2>Pendahuluan<a class="headerlink" href="#pendahuluan" title="Link to this heading">#</a></h2>
<section id="latar-belakang">
<h3>Latar Belakang<a class="headerlink" href="#latar-belakang" title="Link to this heading">#</a></h3>
<p>Dengan semakin mendesaknya tantangan perubahan iklim dan kebutuhan akan sumber energi berkelanjutan, tenaga surya kini memiliki peran yang sangat penting dalam memenuhi kebutuhan energi global. Dalam konteks ini, muncul peluang besar untuk mengatasi masalah bisnis yang relevan: mengoptimalkan performa dan efisiensi pembangkit listrik tenaga surya agar dapat memaksimalkan produksi energi dan berkontribusi pada masa depan yang lebih bersih dan berkelanjutan.</p>
</section>
<section id="rumusan-masalah">
<h3>Rumusan Masalah<a class="headerlink" href="#rumusan-masalah" title="Link to this heading">#</a></h3>
<p>Bagaimana membangun model prediksi yang akurat untuk memproyeksikan daya listrik yang dihasilkan (AC Power) oleh pembangkit listrik tenaga surya pada interval 15 menit ke depan, dengan mempertimbangkan pola harian, faktor cuaca, serta kinerja inverter secara individu dan agregat, untuk mendukung perencanaan operasional yang lebih efisien dan pengelolaan energi yang optimal?</p>
</section>
<section id="tujuan">
<h3>Tujuan<a class="headerlink" href="#tujuan" title="Link to this heading">#</a></h3>
<p>Menggunakan data pembangkitan tenaga surya dan suhu terkait untuk mengeksplorasi peramalan deret waktu (time series forecasting) serta membangun model prediksi jangka pendek untuk tenaga surya.</p>
</section>
<section id="bussines-understanding">
<h3>Bussines Understanding<a class="headerlink" href="#bussines-understanding" title="Link to this heading">#</a></h3>
<p>Dalam era transisi menuju energi terbarukan, pembangkit listrik tenaga surya memiliki peran strategis untuk memenuhi kebutuhan energi yang bersih dan berkelanjutan. Namun, performa pembangkit sering kali dipengaruhi oleh berbagai faktor seperti kondisi cuaca, suhu modul, dan efisiensi operasional. Dengan memanfaatkan data pembangkitan energi dan informasi cuaca, proyek ini bertujuan untuk memahami pola produksi energi dan mengembangkan model prediksi jangka pendek yang dapat membantu meningkatkan efisiensi pembangkit. Melalui analisis ini, pembangkit dapat mengoptimalkan perencanaan produksi, memaksimalkan hasil energi, dan meningkatkan kontribusi terhadap sistem energi bersih secara global. Langkah ini diharapkan tidak hanya mendukung keberlanjutan operasional pembangkit, tetapi juga mendorong pengelolaan energi yang lebih efektif di masa depan.</p>
</section>
<section id="data-understanding">
<h3>Data Understanding<a class="headerlink" href="#data-understanding" title="Link to this heading">#</a></h3>
<p>Data ini diambil dari Pembangkit listrik selama 34 hari, dengan interval pencatatan setiap 15 menit. Dataset ini terdiri dari dua pasang file untuk setiap pembangkit. Setiap pasangan mencakup data pembangkitan energi dan data pembacaan sensor. Data pembangkitan energi berfokus pada tingkat inverter, pusat proses konversi energi, sementara data pembacaan sensor mencerminkan konteks lingkungan yang lebih luas di tingkat pembangkit, yang memengaruhi keluaran energi surya. Data didapat dari Kaggle <a class="reference external" href="https://www.kaggle.com/code/vinayjshetty/solar-power-generation-forecast-using-different-ml">https://www.kaggle.com/code/vinayjshetty/solar-power-generation-forecast-using-different-ml</a>. Kali ini kita akan menggunakan data 1.</p>
<p>Dataset pembangkitan energi mencatat detail mendalam tentang energi yang dihasilkan oleh inverter individual setiap 15 menit. Melalui metrik seperti DC_POWER dan AC_POWER, kita dapat memahami proses konversi energi dari arus searah (DC) ke arus bolak-balik (AC). Selain itu, metrik kumulatif seperti DAILY_YIELD dan TOTAL_YIELD memberikan gambaran tentang produksi energi yang berkelanjutan selama periode waktu tertentu. Sebaliknya, dataset pembacaan sensor menangkap kondisi lingkungan di tingkat pembangkit secara holistik. Dengan menganalisis parameter seperti AMBIENT_TEMPERATURE, MODULE_TEMPERATURE, dan IRRADIATION, kita dapat memahami faktor lingkungan yang memengaruhi efisiensi konversi energi. Data ini menjadi bagian penting untuk memahami hubungan antara panel surya, kondisi sekitarnya, dan iklim secara keseluruhan.</p>
</section>
<section id="library-yang-digunakan">
<h3>Library yang digunakan<a class="headerlink" href="#library-yang-digunakan" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;google&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># linear algebra</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># data processing, CSV file I/O (e.g. pd.read_csv)</span>

<span class="c1">#Additional libraries added for project:</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1">#Data processing</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">KNNImputer</span>

<span class="c1">#Model selection</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">TimeSeriesSplit</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectFromModel</span>

<span class="c1">#ML</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>

<span class="c1">#DL</span>
<span class="c1">#import tensorflow as tf</span>

<span class="c1">#other</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="membaca-data">
<h3>Membaca data<a class="headerlink" href="#membaca-data" title="Link to this heading">#</a></h3>
<p>Data Pembangkit Listrik 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_plt1_gen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/kuliah sem 5/MyData/Plant_1_Generation_Data.csv&#39;</span><span class="p">)</span>

<span class="n">df_plt1_gen</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-98372b52-8c35-49ab-a63e-cb1b0056560a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE_TIME</th>
      <th>PLANT_ID</th>
      <th>SOURCE_KEY</th>
      <th>DC_POWER</th>
      <th>AC_POWER</th>
      <th>DAILY_YIELD</th>
      <th>TOTAL_YIELD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32384</th>
      <td>31-05-2020 15:30</td>
      <td>4135001</td>
      <td>pkci93gMrogZuBj</td>
      <td>3142.571429</td>
      <td>308.771429</td>
      <td>5405.285714</td>
      <td>7294281.286</td>
    </tr>
    <tr>
      <th>58525</th>
      <td>13-06-2020 02:45</td>
      <td>4135001</td>
      <td>zVJPv84UY57bAof</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7328550.000</td>
    </tr>
    <tr>
      <th>26110</th>
      <td>28-05-2020 07:45</td>
      <td>4135001</td>
      <td>McdE0feGgRqW7Ca</td>
      <td>4259.857143</td>
      <td>418.400000</td>
      <td>308.142857</td>
      <td>7256697.143</td>
    </tr>
    <tr>
      <th>17618</th>
      <td>24-05-2020 05:30</td>
      <td>4135001</td>
      <td>WRmjgnKYAwPKWDb</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7093026.000</td>
    </tr>
    <tr>
      <th>3631</th>
      <td>16-05-2020 21:00</td>
      <td>4135001</td>
      <td>YxYtjZvoooNbGkE</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6475.000000</td>
      <td>7192732.000</td>
    </tr>
    <tr>
      <th>39654</th>
      <td>04-06-2020 02:45</td>
      <td>4135001</td>
      <td>WRmjgnKYAwPKWDb</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7174627.000</td>
    </tr>
    <tr>
      <th>22786</th>
      <td>26-05-2020 16:45</td>
      <td>4135001</td>
      <td>iCRJl6heRkivqQ3</td>
      <td>6204.142857</td>
      <td>607.871429</td>
      <td>7617.571429</td>
      <td>7267747.571</td>
    </tr>
    <tr>
      <th>43162</th>
      <td>05-06-2020 19:30</td>
      <td>4135001</td>
      <td>zBIq5rxdHJRwDNY</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7723.000000</td>
      <td>6500302.000</td>
    </tr>
    <tr>
      <th>11802</th>
      <td>21-05-2020 08:00</td>
      <td>4135001</td>
      <td>WRmjgnKYAwPKWDb</td>
      <td>5096.400000</td>
      <td>499.640000</td>
      <td>405.000000</td>
      <td>7070130.000</td>
    </tr>
    <tr>
      <th>52279</th>
      <td>10-06-2020 04:00</td>
      <td>4135001</td>
      <td>1IF53ai7Xc0U56Y</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6380022.000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-98372b52-8c35-49ab-a63e-cb1b0056560a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-98372b52-8c35-49ab-a63e-cb1b0056560a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-98372b52-8c35-49ab-a63e-cb1b0056560a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a8894bad-3ffa-435a-bfdd-c09a8814341e">
  <button class="colab-df-quickchart" onclick="quickchart('df-a8894bad-3ffa-435a-bfdd-c09a8814341e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a8894bad-3ffa-435a-bfdd-c09a8814341e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<p>PLANT_ID bernilai sama di seluruh data, sehingga dapat dihapus tanpa masalah. Nilai generation adalah 0 pada malam hari, yang tentu saja masuk akal untuk tenaga surya. Kemudian kita akan mengganti nama kolom menjadi inverters/inverter agar lebih mudah.</p>
<p>Inverter dalam konteks pembangkit listrik tenaga surya adalah perangkat yang berfungsi untuk mengonversi listrik arus searah (DC - Direct Current) yang dihasilkan oleh panel surya menjadi listrik arus bolak-balik (AC - Alternating Current). Setiap inverter biasanya terhubung ke sejumlah panel surya, dan performanya menjadi indikator penting dalam menganalisis efisiensi sistem pembangkit secara keseluruhan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Since we&#39;re focusing on plant 1 for now we&#39;ll shorten the name</span>
<span class="n">df_gen</span> <span class="o">=</span> <span class="n">df_plt1_gen</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;PLANT_ID&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df_gen</span><span class="p">[</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_gen</span><span class="o">.</span><span class="n">SOURCE_KEY</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="n">df_gen</span><span class="o">.</span><span class="n">SOURCE_KEY</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> \
                                            <span class="sa">f</span><span class="s1">&#39;INVERTER_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> \
                                            <span class="nb">len</span><span class="p">(</span><span class="n">df_gen</span><span class="o">.</span><span class="n">SOURCE_KEY</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">+</span><span class="mi">1</span><span class="p">)})</span>
<span class="n">df_gen</span> <span class="o">=</span> <span class="n">df_gen</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;SOURCE_KEY&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">inverters</span> <span class="o">=</span> <span class="n">df_gen</span><span class="o">.</span><span class="n">INVERTER</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">inverters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;INVERTER_1&#39;, &#39;INVERTER_2&#39;, &#39;INVERTER_3&#39;, &#39;INVERTER_4&#39;,
       &#39;INVERTER_5&#39;, &#39;INVERTER_6&#39;, &#39;INVERTER_7&#39;, &#39;INVERTER_8&#39;,
       &#39;INVERTER_9&#39;, &#39;INVERTER_10&#39;, &#39;INVERTER_11&#39;, &#39;INVERTER_12&#39;,
       &#39;INVERTER_13&#39;, &#39;INVERTER_14&#39;, &#39;INVERTER_15&#39;, &#39;INVERTER_16&#39;,
       &#39;INVERTER_17&#39;, &#39;INVERTER_18&#39;, &#39;INVERTER_19&#39;, &#39;INVERTER_20&#39;,
       &#39;INVERTER_21&#39;, &#39;INVERTER_22&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_gen</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 68778 entries, 0 to 68777
Data columns (total 6 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   DATE_TIME    68778 non-null  object 
 1   DC_POWER     68778 non-null  float64
 2   AC_POWER     68778 non-null  float64
 3   DAILY_YIELD  68778 non-null  float64
 4   TOTAL_YIELD  68778 non-null  float64
 5   INVERTER     68778 non-null  object 
dtypes: float64(4), object(2)
memory usage: 3.1+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_gen</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-deacc3bc-a7bb-4dd1-8507-356b4883bbc8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DATE_TIME</th>
      <td>68778</td>
      <td>3158</td>
      <td>01-06-2020 12:45</td>
      <td>22</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>DC_POWER</th>
      <td>68778.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3147.426211</td>
      <td>4036.457169</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>429.0</td>
      <td>6366.964286</td>
      <td>14471.125</td>
    </tr>
    <tr>
      <th>AC_POWER</th>
      <td>68778.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>307.802752</td>
      <td>394.396439</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>41.49375</td>
      <td>623.61875</td>
      <td>1410.95</td>
    </tr>
    <tr>
      <th>DAILY_YIELD</th>
      <td>68778.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3295.968737</td>
      <td>3145.178309</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2658.714286</td>
      <td>6274.0</td>
      <td>9163.0</td>
    </tr>
    <tr>
      <th>TOTAL_YIELD</th>
      <td>68778.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6978711.760671</td>
      <td>416271.982856</td>
      <td>6183645.0</td>
      <td>6512002.53575</td>
      <td>7146685.0</td>
      <td>7268705.90625</td>
      <td>7846821.0</td>
    </tr>
    <tr>
      <th>INVERTER</th>
      <td>68778</td>
      <td>22</td>
      <td>INVERTER_11</td>
      <td>3155</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-deacc3bc-a7bb-4dd1-8507-356b4883bbc8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-deacc3bc-a7bb-4dd1-8507-356b4883bbc8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-deacc3bc-a7bb-4dd1-8507-356b4883bbc8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e7dd58af-5646-4eb2-821d-832760e6a692">
  <button class="colab-df-quickchart" onclick="quickchart('df-e7dd58af-5646-4eb2-821d-832760e6a692')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e7dd58af-5646-4eb2-821d-832760e6a692 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_gen</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">DATE_TIME</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE_TIME</th>
    </tr>
    <tr>
      <th>INVERTER</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>INVERTER_22</th>
      <td>3104</td>
    </tr>
    <tr>
      <th>INVERTER_7</th>
      <td>3118</td>
    </tr>
    <tr>
      <th>INVERTER_3</th>
      <td>3118</td>
    </tr>
    <tr>
      <th>INVERTER_10</th>
      <td>3119</td>
    </tr>
    <tr>
      <th>INVERTER_2</th>
      <td>3119</td>
    </tr>
    <tr>
      <th>INVERTER_20</th>
      <td>3119</td>
    </tr>
    <tr>
      <th>INVERTER_9</th>
      <td>3123</td>
    </tr>
    <tr>
      <th>INVERTER_5</th>
      <td>3124</td>
    </tr>
    <tr>
      <th>INVERTER_15</th>
      <td>3124</td>
    </tr>
    <tr>
      <th>INVERTER_16</th>
      <td>3124</td>
    </tr>
    <tr>
      <th>INVERTER_21</th>
      <td>3124</td>
    </tr>
    <tr>
      <th>INVERTER_12</th>
      <td>3125</td>
    </tr>
    <tr>
      <th>INVERTER_14</th>
      <td>3125</td>
    </tr>
    <tr>
      <th>INVERTER_17</th>
      <td>3125</td>
    </tr>
    <tr>
      <th>INVERTER_19</th>
      <td>3126</td>
    </tr>
    <tr>
      <th>INVERTER_18</th>
      <td>3126</td>
    </tr>
    <tr>
      <th>INVERTER_13</th>
      <td>3130</td>
    </tr>
    <tr>
      <th>INVERTER_8</th>
      <td>3130</td>
    </tr>
    <tr>
      <th>INVERTER_4</th>
      <td>3133</td>
    </tr>
    <tr>
      <th>INVERTER_6</th>
      <td>3133</td>
    </tr>
    <tr>
      <th>INVERTER_1</th>
      <td>3154</td>
    </tr>
    <tr>
      <th>INVERTER_11</th>
      <td>3155</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label></div></div>
</div>
<p>Tipe data (<em>dtypes</em>) sudah sesuai, tetapi kita perlu mengubah kolom <strong>DATE_TIME</strong> menjadi objek datetime agar lebih mudah dianalisis. Tidak ada nilai kosong (<em>null</em>) yang terdeteksi, namun terlihat ada beberapa data yang hilang.</p>
<p>Di tingkat pembangkit, kita seharusnya memiliki 3264 timestamp unik (34 hari x 24 jam x 4 interval 15 menit per jam), tetapi hanya ada 3158 timestamp. Sedangkan, untuk semua inverter, kita seharusnya memiliki 71808 baris data (3264 x 22 inverter), tetapi yang tersedia hanya 68778 baris. Jadi, sekitar 3000 atau sekitar 4% dari total timestamp yang diharapkan hilang. Ada juga variasi di setiap inverter mengenai timestamp yang hilang, seperti yang terlihat dari jumlah baris inverter di atas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_gen</span><span class="p">[</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_gen</span><span class="o">.</span><span class="n">DATE_TIME</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%Y %H:%M&#39;</span><span class="p">)</span>
<span class="n">df_gen</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DATE_TIME</th>
      <td>datetime64[ns]</td>
    </tr>
    <tr>
      <th>DC_POWER</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>AC_POWER</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>DAILY_YIELD</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>TOTAL_YIELD</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>INVERTER</th>
      <td>object</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> object</label></div></div>
</div>
<p>Data sensor cuaca 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_plt1_weather</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/kuliah sem 5/MyData/Plant_1_Weather_Sensor_Data.csv&#39;</span><span class="p">)</span>

<span class="n">df_plt1_weather</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-14a7b134-647d-4dc5-a59c-3f53bf30864c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE_TIME</th>
      <th>PLANT_ID</th>
      <th>SOURCE_KEY</th>
      <th>AMBIENT_TEMPERATURE</th>
      <th>MODULE_TEMPERATURE</th>
      <th>IRRADIATION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1194</th>
      <td>2020-05-28 02:30:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>22.398088</td>
      <td>20.536780</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2385</th>
      <td>2020-06-09 16:45:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>29.618705</td>
      <td>37.964126</td>
      <td>0.302090</td>
    </tr>
    <tr>
      <th>99</th>
      <td>2020-05-16 03:30:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>21.731421</td>
      <td>20.351884</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2779</th>
      <td>2020-06-13 19:15:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>24.000767</td>
      <td>21.948254</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2020-05-15 03:15:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>24.985215</td>
      <td>24.351508</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2304</th>
      <td>2020-06-08 20:30:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>24.091545</td>
      <td>20.824284</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>442</th>
      <td>2020-05-19 18:00:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>25.046377</td>
      <td>25.426198</td>
      <td>0.001575</td>
    </tr>
    <tr>
      <th>2847</th>
      <td>2020-06-14 12:15:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>24.932560</td>
      <td>36.606858</td>
      <td>0.472765</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2020-05-15 11:15:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>30.216062</td>
      <td>50.006989</td>
      <td>0.585787</td>
    </tr>
    <tr>
      <th>705</th>
      <td>2020-05-22 22:45:00</td>
      <td>4135001</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>23.214526</td>
      <td>21.719092</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-14a7b134-647d-4dc5-a59c-3f53bf30864c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-14a7b134-647d-4dc5-a59c-3f53bf30864c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-14a7b134-647d-4dc5-a59c-3f53bf30864c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-544b5b0b-d31a-4527-b21e-001436b6dff9">
  <button class="colab-df-quickchart" onclick="quickchart('df-544b5b0b-d31a-4527-b21e-001436b6dff9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-544b5b0b-d31a-4527-b21e-001436b6dff9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_plt1_weather</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 3182 entries, 0 to 3181
Data columns (total 6 columns):
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   DATE_TIME            3182 non-null   object 
 1   PLANT_ID             3182 non-null   int64  
 2   SOURCE_KEY           3182 non-null   object 
 3   AMBIENT_TEMPERATURE  3182 non-null   float64
 4   MODULE_TEMPERATURE   3182 non-null   float64
 5   IRRADIATION          3182 non-null   float64
dtypes: float64(3), int64(1), object(2)
memory usage: 149.3+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_plt1_weather</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-7331fe73-35f7-40a7-8c17-b0d4457b7a1d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DATE_TIME</th>
      <td>3182</td>
      <td>3182</td>
      <td>2020-05-15 00:00:00</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>PLANT_ID</th>
      <td>3182.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4135001.0</td>
      <td>0.0</td>
      <td>4135001.0</td>
      <td>4135001.0</td>
      <td>4135001.0</td>
      <td>4135001.0</td>
      <td>4135001.0</td>
    </tr>
    <tr>
      <th>SOURCE_KEY</th>
      <td>3182</td>
      <td>1</td>
      <td>HmiyD2TTLFNqkNe</td>
      <td>3182</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AMBIENT_TEMPERATURE</th>
      <td>3182.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>25.531606</td>
      <td>3.354856</td>
      <td>20.398505</td>
      <td>22.705182</td>
      <td>24.613814</td>
      <td>27.920532</td>
      <td>35.252486</td>
    </tr>
    <tr>
      <th>MODULE_TEMPERATURE</th>
      <td>3182.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31.091015</td>
      <td>12.261222</td>
      <td>18.140415</td>
      <td>21.090553</td>
      <td>24.61806</td>
      <td>41.30784</td>
      <td>65.545714</td>
    </tr>
    <tr>
      <th>IRRADIATION</th>
      <td>3182.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.228313</td>
      <td>0.300836</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.024653</td>
      <td>0.449588</td>
      <td>1.221652</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7331fe73-35f7-40a7-8c17-b0d4457b7a1d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7331fe73-35f7-40a7-8c17-b0d4457b7a1d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7331fe73-35f7-40a7-8c17-b0d4457b7a1d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7b7fabef-8172-4990-b846-5ca0492f77a2">
  <button class="colab-df-quickchart" onclick="quickchart('df-7b7fabef-8172-4990-b846-5ca0492f77a2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7b7fabef-8172-4990-b846-5ca0492f77a2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<p>Kita bisa menghapus kolom <strong>PLANT_ID</strong> dan <strong>SOURCE_KEY</strong> karena nilainya sama di seluruh data. Dan kita ubah kolom <strong>DATE_TIME</strong> menjadi objek datetime agar lebih mudah digunakan dalam analisis. Berdasarkan jumlah <strong>DATE_TIME</strong>, kita juga bisa melihat bahwa ada beberapa data cuaca yang hilang.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_weather</span> <span class="o">=</span> <span class="n">df_plt1_weather</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;PLANT_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;SOURCE_KEY&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_weather</span><span class="p">[</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_weather</span><span class="o">.</span><span class="n">DATE_TIME</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Untuk mengisi <strong>datetime</strong> yang hilang pada dataset pembangkitan dan sensor cuaca, kita akan membuat objek datetime dengan rentang waktu penuh yang diharapkan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datetimes_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">df_gen</span><span class="o">.</span><span class="n">DATE_TIME</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                         <span class="n">df_gen</span><span class="o">.</span><span class="n">DATE_TIME</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                         <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;15min&#39;</span><span class="p">),</span>
                           <span class="n">name</span><span class="o">=</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">)</span>
<span class="n">datetimes_full</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE_TIME</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-05-15 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-05-15 00:15:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-05-15 00:30:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-05-15 00:45:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-05-15 01:00:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>3259</th>
      <td>2020-06-17 22:45:00</td>
    </tr>
    <tr>
      <th>3260</th>
      <td>2020-06-17 23:00:00</td>
    </tr>
    <tr>
      <th>3261</th>
      <td>2020-06-17 23:15:00</td>
    </tr>
    <tr>
      <th>3262</th>
      <td>2020-06-17 23:30:00</td>
    </tr>
    <tr>
      <th>3263</th>
      <td>2020-06-17 23:45:00</td>
    </tr>
  </tbody>
</table>
<p>3264 rows Ã— 1 columns</p>
</div><br><label><b>dtype:</b> datetime64[ns]</label></div></div>
</div>
</section>
<section id="menggabungkan-data">
<h3>Menggabungkan data<a class="headerlink" href="#menggabungkan-data" title="Link to this heading">#</a></h3>
<p>Sekarang kita siap untuk menggabungkan ini dengan dataset kita. Dimulai dengan dataset pembangkitan: karena setiap inverter memiliki beberapa <strong>datetime</strong> yang hilang, kita perlu melakukannya satu inverter pada satu waktu, kemudian menggabungkan hasilnya kembali menjadi satu dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfs_gen</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inverters</span><span class="p">:</span>
    <span class="n">df_inverter</span> <span class="o">=</span> <span class="n">df_gen</span><span class="p">[</span><span class="n">df_gen</span><span class="o">.</span><span class="n">INVERTER</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">df_inverter</span> <span class="o">=</span> <span class="n">df_inverter</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">datetimes_full</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
    <span class="n">df_inverter</span><span class="p">[</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">dfs_gen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_inverter</span><span class="p">)</span>
<span class="n">df_gen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs_gen</span><span class="p">)</span>
<span class="n">df_gen</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 71808 entries, 0 to 3263
Data columns (total 6 columns):
 #   Column       Non-Null Count  Dtype         
---  ------       --------------  -----         
 0   DATE_TIME    71808 non-null  datetime64[ns]
 1   DC_POWER     68778 non-null  float64       
 2   AC_POWER     68778 non-null  float64       
 3   DAILY_YIELD  68778 non-null  float64       
 4   TOTAL_YIELD  68778 non-null  float64       
 5   INVERTER     71808 non-null  object        
dtypes: datetime64[ns](1), float64(4), object(1)
memory usage: 3.8+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_gen</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_weather</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 71808 entries, 0 to 71807
Data columns (total 9 columns):
 #   Column               Non-Null Count  Dtype         
---  ------               --------------  -----         
 0   DATE_TIME            71808 non-null  datetime64[ns]
 1   DC_POWER             68778 non-null  float64       
 2   AC_POWER             68778 non-null  float64       
 3   DAILY_YIELD          68778 non-null  float64       
 4   TOTAL_YIELD          68778 non-null  float64       
 5   INVERTER             71808 non-null  object        
 6   AMBIENT_TEMPERATURE  70004 non-null  float64       
 7   MODULE_TEMPERATURE   70004 non-null  float64       
 8   IRRADIATION          70004 non-null  float64       
dtypes: datetime64[ns](1), float64(7), object(1)
memory usage: 4.9+ MB
</pre></div>
</div>
</div>
</div>
</section>
<section id="eksplorasi-data">
<h3>Eksplorasi Data<a class="headerlink" href="#eksplorasi-data" title="Link to this heading">#</a></h3>
<p>Untuk memulai analisis yang lebih mendalam, kita akan membuat beberapa fitur dasar dari <strong>datetime</strong>. Jika kita melakukan pemodelan untuk periode sepanjang tahun atau lebih lama, informasi seperti bulan dan tahun bisa menjadi penting untuk menangkap variasi musiman dan tren jangka panjang. Namun, karena data kita hanya mencakup 34 hari, kita akan mengabaikan fitur tersebut. Sebagai gantinya, kita dapat menggunakan fitur <strong>dayofyear</strong> untuk menangkap tren jangka panjang yang mungkin ada selama periode tersebut.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;HOUR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">DATE_TIME</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">DATE_TIME</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAY_WEEK&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">DATE_TIME</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">DATE_TIME</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">time</span>

<span class="c1">#This maps the 15 minute intervals over the course of the day to ints 1-96.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">MINUTES_15</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="n">df</span><span class="o">.</span><span class="n">MINUTES_15</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">97</span><span class="p">)})</span>
<span class="c1">#Change day of year to day of data</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">DAY</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="n">df</span><span class="o">.</span><span class="n">DAY</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">35</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<p>Kita cek korelasi yang linier pada setiap fitur</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">corr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9386f12a-b172-4a15-9a1d-8d6326c52923" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DC_POWER</th>
      <th>AC_POWER</th>
      <th>DAILY_YIELD</th>
      <th>TOTAL_YIELD</th>
      <th>AMBIENT_TEMPERATURE</th>
      <th>MODULE_TEMPERATURE</th>
      <th>IRRADIATION</th>
      <th>HOUR</th>
      <th>DAY</th>
      <th>DAY_WEEK</th>
      <th>MINUTES_15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DC_POWER</th>
      <td>1.000000</td>
      <td>0.999996</td>
      <td>0.082284</td>
      <td>0.003815</td>
      <td>0.724668</td>
      <td>0.954811</td>
      <td>0.989391</td>
      <td>2.410437e-02</td>
      <td>-3.053931e-02</td>
      <td>1.764947e-02</td>
      <td>2.413064e-02</td>
    </tr>
    <tr>
      <th>AC_POWER</th>
      <td>0.999996</td>
      <td>1.000000</td>
      <td>0.082234</td>
      <td>0.003804</td>
      <td>0.724903</td>
      <td>0.954924</td>
      <td>0.989340</td>
      <td>2.410128e-02</td>
      <td>-3.047131e-02</td>
      <td>1.764008e-02</td>
      <td>2.412678e-02</td>
    </tr>
    <tr>
      <th>DAILY_YIELD</th>
      <td>0.082284</td>
      <td>0.082234</td>
      <td>1.000000</td>
      <td>0.009867</td>
      <td>0.478496</td>
      <td>0.198308</td>
      <td>0.078317</td>
      <td>8.361242e-01</td>
      <td>-3.013040e-03</td>
      <td>2.716671e-02</td>
      <td>8.362076e-01</td>
    </tr>
    <tr>
      <th>TOTAL_YIELD</th>
      <td>0.003815</td>
      <td>0.003804</td>
      <td>0.009867</td>
      <td>1.000000</td>
      <td>-0.036150</td>
      <td>-0.015596</td>
      <td>-0.005490</td>
      <td>4.988189e-03</td>
      <td>1.728681e-01</td>
      <td>-1.818331e-02</td>
      <td>4.990603e-03</td>
    </tr>
    <tr>
      <th>AMBIENT_TEMPERATURE</th>
      <td>0.724668</td>
      <td>0.724903</td>
      <td>0.478496</td>
      <td>-0.036150</td>
      <td>1.000000</td>
      <td>0.853778</td>
      <td>0.722999</td>
      <td>3.222789e-01</td>
      <td>-2.204906e-01</td>
      <td>5.673201e-02</td>
      <td>3.219509e-01</td>
    </tr>
    <tr>
      <th>MODULE_TEMPERATURE</th>
      <td>0.954811</td>
      <td>0.954924</td>
      <td>0.198308</td>
      <td>-0.015596</td>
      <td>0.853778</td>
      <td>1.000000</td>
      <td>0.961566</td>
      <td>1.027911e-01</td>
      <td>-9.264400e-02</td>
      <td>3.505704e-02</td>
      <td>1.026066e-01</td>
    </tr>
    <tr>
      <th>IRRADIATION</th>
      <td>0.989391</td>
      <td>0.989340</td>
      <td>0.078317</td>
      <td>-0.005490</td>
      <td>0.722999</td>
      <td>0.961566</td>
      <td>1.000000</td>
      <td>1.580428e-02</td>
      <td>-3.039712e-02</td>
      <td>2.126718e-02</td>
      <td>1.579879e-02</td>
    </tr>
    <tr>
      <th>HOUR</th>
      <td>0.024104</td>
      <td>0.024101</td>
      <td>0.836124</td>
      <td>0.004988</td>
      <td>0.322279</td>
      <td>0.102791</td>
      <td>0.015804</td>
      <td>1.000000e+00</td>
      <td>2.607124e-16</td>
      <td>-2.829067e-17</td>
      <td>9.991858e-01</td>
    </tr>
    <tr>
      <th>DAY</th>
      <td>-0.030539</td>
      <td>-0.030471</td>
      <td>-0.003013</td>
      <td>0.172868</td>
      <td>-0.220491</td>
      <td>-0.092644</td>
      <td>-0.030397</td>
      <td>2.607124e-16</td>
      <td>1.000000e+00</td>
      <td>-1.034175e-01</td>
      <td>9.708847e-17</td>
    </tr>
    <tr>
      <th>DAY_WEEK</th>
      <td>0.017649</td>
      <td>0.017640</td>
      <td>0.027167</td>
      <td>-0.018183</td>
      <td>0.056732</td>
      <td>0.035057</td>
      <td>0.021267</td>
      <td>-2.829067e-17</td>
      <td>-1.034175e-01</td>
      <td>1.000000e+00</td>
      <td>6.468614e-18</td>
    </tr>
    <tr>
      <th>MINUTES_15</th>
      <td>0.024131</td>
      <td>0.024127</td>
      <td>0.836208</td>
      <td>0.004991</td>
      <td>0.321951</td>
      <td>0.102607</td>
      <td>0.015799</td>
      <td>9.991858e-01</td>
      <td>9.708847e-17</td>
      <td>6.468614e-18</td>
      <td>1.000000e+00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9386f12a-b172-4a15-9a1d-8d6326c52923')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9386f12a-b172-4a15-9a1d-8d6326c52923 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9386f12a-b172-4a15-9a1d-8d6326c52923');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d5347e14-1814-4c63-a1d0-eac529aeb88d">
  <button class="colab-df-quickchart" onclick="quickchart('df-d5347e14-1814-4c63-a1d0-eac529aeb88d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d5347e14-1814-4c63-a1d0-eac529aeb88d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_cc6e98b2-be96-4c52-93dc-5e8605dd25de">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('corr')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_cc6e98b2-be96-4c52-93dc-5e8605dd25de button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('corr');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6b50ff3e39738bb85679718da14db30ccb9273c700edf4b5008f5afc0cdbca63.png" src="_images/6b50ff3e39738bb85679718da14db30ccb9273c700edf4b5008f5afc0cdbca63.png" />
</div>
</div>
<p>Korelasi yang tinggi antara DC dan AC power menunjukkan bahwa inverter bekerja dengan baik untuk mengubah energi dari bentuk DC ke AC. Kita akan menggunakan AC_POWER sebagai target dalam analisis. Ada hubungan yang jelas antara jam dalam sehari (HOUR) dan hasil energi harian (DAILY_YIELD), yang makin meningkat seiring berjalannya waktu. Untuk data cuaca, IRRADIATION dan MODULE_TEMPERATURE memiliki korelasi yang kuat dengan AC_POWER. Selanjutnya, kita akan membuat grafik pairplot untuk memvisualisasikan hubungan-hubungan ini dan mencari apakah ada korelasi yang tidak linear.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">diag_sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_upper</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8883b38e8734e05a7ee63e02322aea2751d4bf407d8aae9463dd064602e8b731.png" src="_images/8883b38e8734e05a7ee63e02322aea2751d4bf407d8aae9463dd064602e8b731.png" />
</div>
</div>
<p><strong>Penjelasan:</strong></p>
<ul class="simple">
<li><p><strong>Zero values pada AC_POWER, DC_POWER, dan DAILY_YIELD</strong> terjadi karena pada malam hari pembangkit tidak menghasilkan energi, yang normal untuk sistem tenaga surya.</p></li>
<li><p><strong>Missing data</strong> dapat terlihat dari hubungan <strong>DAY</strong> dan <strong>MINUTES_15</strong>, yang mengindikasikan ada data yang hilang pada beberapa waktu.</p></li>
<li><p><strong>Perbedaan kapasitas inverter</strong> menunjukkan bahwa beberapa inverter menghasilkan lebih banyak energi daripada yang lain, yang bisa disebabkan oleh faktor seperti umur inverter, lokasi, atau pemeliharaan.</p></li>
<li><p>Hubungan antara <strong>HOUR</strong> dan <strong>AC_POWER</strong> menunjukkan puncak pembangkit di siang hari, yang sesuai dengan ekspektasi bahwa produksi energi surya lebih tinggi pada siang hari.</p></li>
</ul>
</section>
</section>
<section id="outlier">
<h2>Outlier<a class="headerlink" href="#outlier" title="Link to this heading">#</a></h2>
<p>Pertama, lakukan pemeriksaan cepat untuk melihat apakah ada angka daya negatif.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">,</span> <span class="s1">&#39;DC_POWER&#39;</span><span class="p">,</span> <span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTAL_YIELD&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AC_POWER</th>
      <td>False</td>
    </tr>
    <tr>
      <th>DC_POWER</th>
      <td>False</td>
    </tr>
    <tr>
      <th>DAILY_YIELD</th>
      <td>False</td>
    </tr>
    <tr>
      <th>TOTAL_YIELD</th>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> bool</label></div></div>
</div>
<p>Mari kita jelajahi target kita, <strong>AC_POWER</strong>. Kita dapat mendefinisikan <strong>outlier</strong> sebagai nilai yang lebih kecil dari persentil ke-1 atau lebih besar dari persentil ke-99. Untuk melakukan ini, kita akan membuat empat fitur kuantil: dua di antaranya berada dalam rentang <strong>outlier</strong> dan dua lainnya untuk menetapkan satu deviasi standar dari rata-rata. Setelah itu, kita bisa memplot hasilnya.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Making a new dataframe for EDA since we won&#39;t necessarily want these features for our model.</span>
<span class="n">df_eda</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_eda</span> <span class="o">=</span> <span class="n">df_eda</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_eda</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OUTLIERS_LOW_AC_POWER&#39;</span><span class="p">),</span>
                      <span class="n">on</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                      <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df_eda</span> <span class="o">=</span> <span class="n">df_eda</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_eda</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;OUTLIERS_HIGH_AC_POWER&#39;</span><span class="p">),</span>
                      <span class="n">on</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                      <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df_eda</span> <span class="o">=</span> <span class="n">df_eda</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_eda</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;MEAN&#39;</span><span class="p">),</span>
                       <span class="n">on</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                       <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df_eda</span> <span class="o">=</span> <span class="n">df_eda</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_eda</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">AC_POWER</span>\
                      <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;STD&#39;</span><span class="p">),</span>
                      <span class="n">on</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                      <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df_eda</span><span class="p">[</span><span class="s1">&#39;STD_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_eda</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;AC_POWER &lt; (MEAN + STD) and AC_POWER &gt; (MEAN - STD)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">AC_POWER</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Since we have nulls in our data now we will exclude those with df[~df.isna()]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;Paired&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_eda</span><span class="p">[</span><span class="o">~</span><span class="n">df_eda</span><span class="o">.</span><span class="n">isna</span><span class="p">()],</span>
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_eda</span><span class="p">[</span><span class="o">~</span><span class="n">df_eda</span><span class="o">.</span><span class="n">isna</span><span class="p">()],</span>
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;STD_1&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_eda</span><span class="p">[</span><span class="o">~</span><span class="n">df_eda</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;AC_POWER &gt; OUTLIERS_HIGH_AC_POWER&#39;</span><span class="p">),</span>
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_eda</span><span class="p">[</span><span class="o">~</span><span class="n">df_eda</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;AC_POWER &lt; OUTLIERS_LOW_AC_POWER&#39;</span><span class="p">),</span>
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span> <span class="o">-</span><span class="n">df_eda</span><span class="p">[</span><span class="o">~</span><span class="n">df_eda</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;AC Power per 15 minutes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;AC Power (kW)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hour of Day&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;+/- 1</span><span class="se">\u03C3</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;Full data&#39;</span><span class="p">,</span> <span class="s1">&#39;Outliers&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/98df345ccf42d7b44ba8f18c3b27d214977d83a6c497f352a725f21f5a9e0ca8.png" src="_images/98df345ccf42d7b44ba8f18c3b27d214977d83a6c497f352a725f21f5a9e0ca8.png" />
</div>
</div>
<p>tampaknya ada beberapa kejadian di mana daya yang dihasilkan pada tengah hari adalah 0. Ini bisa menunjukkan adanya data yang buruk, inverter yang rusak, perawatan yang dijadwalkan, hari yang berawan, hari cerah di mana pembangkit sudah mencapai kapasitas maksimal, atau berbagai kemungkinan lainnya. Tanpa pengetahuan lebih dalam tentang domain ini, sulit untuk memastikan penyebab pastinya, namun mari kita coba mencari pola dari outliers di tengah hari tersebut.</p>
<p>Pertama, kita akan memeriksa apakah ada inverter tertentu yang bertanggung jawab atas masalah ini.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outliers_low</span> <span class="o">=</span> <span class="n">df_eda</span><span class="p">[</span><span class="o">~</span><span class="n">df_eda</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;AC_POWER &lt; OUTLIERS_LOW_AC_POWER&#39;</span><span class="p">)</span>
<span class="n">outliers_high</span> <span class="o">=</span> <span class="n">df_eda</span><span class="p">[</span><span class="o">~</span><span class="n">df_eda</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;AC_POWER &gt; OUTLIERS_HIGH_AC_POWER&#39;</span><span class="p">)</span>

<span class="n">outliers_source_low</span> <span class="o">=</span> <span class="n">outliers_low</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">)</span>\
                                  <span class="o">.</span><span class="n">count</span><span class="p">()</span>\
                                  <span class="o">.</span><span class="n">DATE_TIME</span>\
                                  <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
                                  <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">outliers_source_low_zero</span> <span class="o">=</span> <span class="n">outliers_low</span><span class="p">[</span><span class="n">outliers_low</span><span class="o">.</span><span class="n">AC_POWER</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">)</span>\
                                                    <span class="o">.</span><span class="n">count</span><span class="p">()</span>\
                                                    <span class="o">.</span><span class="n">DATE_TIME</span>\
                                                    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
                                                    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">outliers_source_low</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">,</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">outliers_source_low_zero</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Outlier Counts by Inverter (shading for 0.0 AC Power)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inverter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cf31f5c5b9c647c8ba388d369349de0cb1181fda9314cc1fd2a7ae7bcb900d72.png" src="_images/cf31f5c5b9c647c8ba388d369349de0cb1181fda9314cc1fd2a7ae7bcb900d72.png" />
</div>
</div>
<p>Sebaran jumlah <strong>outlier</strong>, termasuk pengukuran <strong>AC_POWER</strong> yang bernilai 0.0, terkonsentrasi pada inverter 11 dan 1. Kemungkinan besar, inverter-inverter ini mati untuk jangka waktu yang lama karena pemeliharaan atau kerusakan. Di bawah ini, kita akan melihat sebaran <strong>outlier</strong> tersebut selama 34 hari penuh untuk melihat apakah ada pola yang teratur.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outliers_zero_count</span> <span class="o">=</span> <span class="n">outliers_low</span><span class="p">[</span><span class="n">outliers_low</span><span class="o">.</span><span class="n">AC_POWER</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span><span class="s1">&#39;DAY&#39;</span><span class="p">])</span>\
                                                              <span class="o">.</span><span class="n">count</span><span class="p">()</span>\
                                                              <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">:</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">})</span>\
                                                              <span class="o">.</span><span class="n">COUNTS</span>\
                                                              <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">outliers_zero_count</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">outliers_zero_count</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;DAY&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;brief&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">35</span><span class="p">)]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/80008f157c7d4d5e4eb72cc2d0e284e05eaa69676351170b2f2d91447a6fa3af.png" src="_images/80008f157c7d4d5e4eb72cc2d0e284e05eaa69676351170b2f2d91447a6fa3af.png" />
</div>
</div>
<p>Beberapa outlier terjadi pada hari yang sama. Mungkin ada pemeliharaan pada hari tersebut atau masalah lainnya. Sekarang, mari kita periksa apakah ada pola mingguan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outliers_zero_count</span> <span class="o">=</span> <span class="n">outliers_low</span><span class="p">[</span><span class="n">outliers_low</span><span class="o">.</span><span class="n">AC_POWER</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span><span class="s1">&#39;DAY_WEEK&#39;</span><span class="p">])</span>\
                                                              <span class="o">.</span><span class="n">count</span><span class="p">()</span>\
                                                              <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">:</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">})</span>\
                                                              <span class="o">.</span><span class="n">COUNTS</span>\
                                                              <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">outliers_zero_count</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">outliers_zero_count</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;DAY_WEEK&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3429182cff01476a9adc1d675ded663c27644bec495ad443766d9ccba341e1bd.png" src="_images/3429182cff01476a9adc1d675ded663c27644bec495ad443766d9ccba341e1bd.png" />
</div>
</div>
<p>Beberapa nilai nol terjadi pada hari Minggu. Ini bisa jadi kebetulan, atau mungkin menunjukkan adanya pemeliharaan yang dijadwalkan. Karena Minggu kemungkinan adalah hari dengan permintaan yang lebih rendah di jaringan listrik, masuk akal jika hari itu dipilih untuk pemeliharaan atau pemadaman terencana. Sekarang, mari kita kembali dan periksa <strong>outlier</strong> yang bukan nol.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outliers_low_count</span> <span class="o">=</span> <span class="n">outliers_low</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span><span class="s1">&#39;DAY_WEEK&#39;</span><span class="p">])</span>\
                                 <span class="o">.</span><span class="n">count</span><span class="p">()</span>\
                                 <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">:</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">})</span>\
                                 <span class="o">.</span><span class="n">COUNTS</span>\
                                 <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">outliers_low_count</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;DAY_WEEK&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;COUNTS&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0bee25a444c965ae2f9192dddb7cdf52413516089ae822885acee033e6facdc2.png" src="_images/0bee25a444c965ae2f9192dddb7cdf52413516089ae822885acee033e6facdc2.png" />
</div>
</div>
<p>Jumlah <strong>outlier</strong> secara keseluruhan lebih banyak terjadi pada hari Senin. Kita bisa menduga bahwa setelah pemeliharaan pada hari Minggu, ada keterlambatan dalam mengaktifkan kembali semua sistem yang berlanjut hingga hari Senin. Saya rasa sekarang sudah ada cukup bukti untuk memutuskan untuk tetap mempertahankan <strong>outlier</strong> ini dalam data, karena ini bisa membantu model untuk memperhitungkan beberapa kondisi tersebut. Meskipun begitu, jumlahnya cukup rendah sehingga kemungkinan besar tidak akan berdampak terlalu besar pada hasil model.</p>
<p>Mari kita lihat dengan cepat <strong>outlier</strong> pada fitur lainnya, sebelum melanjutkan ke data yang hilang. Karena kita akan memeriksa beberapa fitur yang berbeda, kita bisa membuat sebuah fungsi untuk membantu mempercepat proses ini.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">outliers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">high_per</span><span class="p">,</span> <span class="n">low_per</span><span class="p">,</span> <span class="n">source_key</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">)</span>\
                  <span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">low_per</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">feature</span><span class="p">]</span>\
                  <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;OUTLIERS_LOW_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
                  <span class="n">on</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                  <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">)</span>\
                  <span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">high_per</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">feature</span><span class="p">]</span>\
                  <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;OUTLIERS_HIGH_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
                  <span class="n">on</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                  <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">)</span>\
                  <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">feature</span><span class="p">]</span>\
                  <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MEAN_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
                  <span class="n">on</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                  <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">)</span>\
                  <span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">feature</span><span class="p">]</span>\
                  <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;STD_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
                  <span class="n">on</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                  <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;STD_1_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> &lt; (MEAN_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> + STD_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">) </span><span class="se">\</span>
<span class="s1">                                      and </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> &gt; (MEAN_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> - STD_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)[</span><span class="n">feature</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;Paired&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">source_key</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                        <span class="n">y</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                        <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                        <span class="n">y</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;STD_1_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                        <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> &gt; OUTLIERS_HIGH_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
                        <span class="n">y</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                        <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">feature</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> &lt; OUTLIERS_LOW_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
                        <span class="n">y</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                        <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span> <span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                        <span class="n">y</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
                        <span class="n">y</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;STD_1_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> &gt; OUTLIERS_HIGH_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
                        <span class="n">y</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">feature</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> &lt; OUTLIERS_LOW_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
                        <span class="n">y</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span> <span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> per 15 minutes&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hour of Day&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Full data&#39;</span><span class="p">,</span> <span class="s1">&#39;+/- 1</span><span class="se">\u03C3</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Outliers&#39;</span><span class="p">]);</span>
    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax_daily_yield</span><span class="p">,</span> <span class="n">df_daily_yield</span> <span class="o">=</span> <span class="n">outliers</span><span class="p">(</span><span class="n">df_eda</span><span class="p">[</span><span class="o">~</span><span class="n">df_eda</span><span class="o">.</span><span class="n">isna</span><span class="p">()],</span> <span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2cf7eb822e0e7824ab34b2f028e0f80b48111bc25faf25de0571833f24ded8e1.png" src="_images/2cf7eb822e0e7824ab34b2f028e0f80b48111bc25faf25de0571833f24ded8e1.png" />
</div>
</div>
<p>Ada beberapa hal yang tidak biasa di sini, terutama angka 0 setelah jam 6 sore. Garis turun yang tajam di akhir hari dan garis lainnya di awal hari. Ini sepertinya bisa jadi data yang salah, atau mungkin semacam koreksi dari data sebelumnya. Apa pun penyebab pastinya, sebaiknya kita perbaiki ini agar data tidak terlalu terputus-putus dan pada akhirnya membantu model kita. Untuk memperbaikinya, kita akan setel setiap nilai selama malam hari menjadi hasil <strong>yield</strong> harian maksimum, dan atur semua hasil <strong>yield</strong> harian di awal hari menjadi 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Had a go through a few trys to settle on MINUTES_15 = 75 as a good starting point for night.</span>
<span class="n">nighttime</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span><span class="mi">97</span><span class="p">)]</span>
<span class="c1">#Making these changes to the original df</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">HOUR</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">#We need a maximun daily yield for each inverter seperately</span>
<span class="n">daily_yield</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">daily_yield</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;DAILY_YIELD_DAY_MAX&#39;</span> <span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span> <span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="s1">&#39;DAY&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()[</span><span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">]})</span>\
                       <span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
                       <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="s1">&#39;DAY&#39;</span><span class="p">],</span>
                       <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">MINUTES_15</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">nighttime</span><span class="p">),</span>
                                           <span class="n">daily_yield</span><span class="p">[</span><span class="s1">&#39;DAILY_YIELD_DAY_MAX&#39;</span><span class="p">])</span>

<span class="n">ax_daily_yield</span><span class="p">,</span> <span class="n">df_daily_yield</span> <span class="o">=</span> <span class="n">outliers</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()],</span> <span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/712d917da2b6c8236c708d7713fb424dffffe4f79bd050257c935508d616c1f7.png" src="_images/712d917da2b6c8236c708d7713fb424dffffe4f79bd050257c935508d616c1f7.png" />
</div>
</div>
<p>Sekarang ini sudah lebih baik. Masih perlu dilihat seberapa besar pengaruh <strong>daily yield</strong> terhadap model kita, tapi setidaknya ini akan membantu sedikit.</p>
<section id="missing-value">
<h3>Missing Value<a class="headerlink" href="#missing-value" title="Link to this heading">#</a></h3>
<p>Sekarang kita siap untuk mengisi nilai yang hilang sebagai langkah terakhir sebelum memulai pemodelan. Pertama, mari kita cari bagian data yang hilang untuk digunakan sebagai kasus uji untuk melihat seberapa efektif pengisi nilai (<strong>imputer</strong>) kita.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">isna</span><span class="p">()],</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;DAY&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Data points&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ae95bbbebb9da26f78c0ed2410d618512026776f8123287cc4077b9ae15c439f.png" src="_images/ae95bbbebb9da26f78c0ed2410d618512026776f8123287cc4077b9ae15c439f.png" />
</div>
</div>
<p>Ada cukup banyak data yang hilang pada hari ke-6, jadi kita bisa menggunakan hari ini untuk menguji <strong>imputer</strong> kita dengan plot perbandingan sebelum dan setelah pengisian nilai yang hilang.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()][</span><span class="n">df</span><span class="o">.</span><span class="n">DAY</span> <span class="o">==</span> <span class="mi">6</span><span class="p">],</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Day 6 AC Power before imputing&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3425c6910ed2c9064e50e0684e6a9572010e26c714aea83fd7337a77a414cec1.png" src="_images/3425c6910ed2c9064e50e0684e6a9572010e26c714aea83fd7337a77a414cec1.png" />
</div>
</div>
<p>Imputasi akan dilakukan menggunakan KNNImputer</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputer</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">inverter_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">inverter_df</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inverters</span><span class="p">:</span>
    <span class="n">inverter_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">INVERTER</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">inverter_df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">)</span>
    <span class="n">inverter_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">inverter_df</span><span class="p">[</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">]</span>
    <span class="n">datetime</span> <span class="o">=</span> <span class="n">inverter_df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">)</span>
    <span class="n">inverter_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">inverter_df</span><span class="p">),</span>
                               <span class="n">columns</span><span class="o">=</span><span class="n">inverter_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                               <span class="n">index</span><span class="o">=</span><span class="n">datetime</span><span class="p">)</span>
    <span class="n">inverter_df</span><span class="p">[</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">inverter_df</span> <span class="o">=</span> <span class="n">inverter_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">inverter_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inverter_df</span><span class="p">)</span>
<span class="n">df_knn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">inverter_dfs</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_knn</span><span class="p">[</span><span class="n">df_knn</span><span class="o">.</span><span class="n">DAY</span> <span class="o">==</span> <span class="mi">6</span><span class="p">],</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Day 6 AC Power Imputed with KNN&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/06658394240de02f97f2b90215480a3f927d86bde850375dc6aaf564c102c69e.png" src="_images/06658394240de02f97f2b90215480a3f927d86bde850375dc6aaf564c102c69e.png" />
</div>
</div>
<p>Karena KNNImputer bekerja dengan baik, maka kita akan membuat fungsi imputer nya</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">imputer</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">imputer</span><span class="o">=</span><span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">)):</span>
    <span class="n">imputer</span> <span class="o">=</span> <span class="n">imputer</span>
    <span class="n">inverter_dfs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">inverter_df</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inverters</span><span class="p">:</span>
        <span class="n">inverter_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">INVERTER</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">inverter_df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">)</span>
        <span class="n">inverter_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">inverter_df</span><span class="p">[</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">]</span>
        <span class="n">datetime</span> <span class="o">=</span> <span class="n">inverter_df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">)</span>
        <span class="n">inverter_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">inverter_df</span><span class="p">),</span>
                                   <span class="n">columns</span><span class="o">=</span><span class="n">inverter_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                                   <span class="n">index</span><span class="o">=</span><span class="n">datetime</span><span class="p">)</span>
        <span class="n">inverter_df</span><span class="p">[</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">inverter_df</span> <span class="o">=</span> <span class="n">inverter_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">inverter_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inverter_df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">inverter_dfs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">imputer</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 71808 entries, 0 to 3263
Data columns (total 13 columns):
 #   Column               Non-Null Count  Dtype         
---  ------               --------------  -----         
 0   DATE_TIME            71808 non-null  datetime64[ns]
 1   DC_POWER             71808 non-null  float64       
 2   AC_POWER             71808 non-null  float64       
 3   DAILY_YIELD          71808 non-null  float64       
 4   TOTAL_YIELD          71808 non-null  float64       
 5   AMBIENT_TEMPERATURE  71808 non-null  float64       
 6   MODULE_TEMPERATURE   71808 non-null  float64       
 7   IRRADIATION          71808 non-null  float64       
 8   HOUR                 71808 non-null  float64       
 9   DAY                  71808 non-null  float64       
 10  DAY_WEEK             71808 non-null  float64       
 11  MINUTES_15           71808 non-null  float64       
 12  INVERTER             71808 non-null  object        
dtypes: datetime64[ns](1), float64(11), object(1)
memory usage: 7.7+ MB
</pre></div>
</div>
</div>
</div>
</section>
<section id="target">
<h3>Target<a class="headerlink" href="#target" title="Link to this heading">#</a></h3>
<p>Sebelum menetapkan baseline, kita perlu membuat target kita. Seperti yang disebutkan sebelumnya, target kita akan berupa jumlah pembangkit daya <strong>AC</strong> dari semua inverter untuk interval 15 menit tertentu yang diprediksi untuk hari berikutnya. Jadi, mari kita buat target tersebut dan periksalah lebih dekat sebelum menetapkan baseline.<strong>bold text</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">day</span> <span class="o">=</span> <span class="mi">96</span>
<span class="c1">#shifting to day ahead and dropping nulls cause by the shift</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="n">day</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Melihat target kita selama satu minggu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">target</span><span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="s1">&#39;2020-06-10&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;One Week of Power Generation (kW)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/49a3f75c4425ae998162894b2775daa7949a731faa31aeb2aff8c5430cd40cc9.png" src="_images/49a3f75c4425ae998162894b2775daa7949a731faa31aeb2aff8c5430cd40cc9.png" />
</div>
</div>
<p>data yang ingin diprediksi (AC_POWER) memiliki fluktuasi yang signifikan, dengan banyak kenaikan dan penurunan tajam. Untuk menangani hal ini, salah satu pendekatannya adalah dengan memodelkan kinerja setiap inverter secara terpisah, atau dengan menggabungkan data dari semua inverter dalam satu model. Ini bisa membantu model untuk lebih baik menangkap pola yang berbeda antar inverter atau mengurangi variasi yang besar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">INVERTER</span> <span class="o">==</span> <span class="n">inverters</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">DATE_TIME</span> <span class="o">&gt;</span> <span class="s1">&#39;2020-06-10&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Inverter 5: One Week of Power Generation (kW)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eb12c6eb86c337427b207eb2af36c90163fd541f2e2eeaace86bc544734f1dfb.png" src="_images/eb12c6eb86c337427b207eb2af36c90163fd541f2e2eeaace86bc544734f1dfb.png" />
</div>
</div>
<p>Namun, jika kita hanya melihat satu inverter, ternyata tidak ada perbedaan signifikan dalam meratakan data. Jadi, perbedaan antara memodelkan data inverter secara terpisah atau hanya menggabungkannya mungkin tidak terlalu besar. Bagaimanapun, kita akan mencoba kedua pendekatan tersebut untuk membandingkan hasilnya. Sekarang, mari kita lihat hasilnya berdasarkan jam.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_hour</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">target_hour</span><span class="p">[</span><span class="n">target_hour</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="s1">&#39;2020-06-10&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;One Week of Hourly Power Generation (kW)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b1d25974680285c8c7aa0f761e69ccb636486cc5b0865677038b6a8b6f392ae2.png" src="_images/b1d25974680285c8c7aa0f761e69ccb636486cc5b0865677038b6a8b6f392ae2.png" />
</div>
</div>
<p>dengan meratakan data ke dalam rentang waktu yang lebih besar seperti per jam, data menjadi lebih stabil dan lebih mudah untuk dianalisis oleh model. Namun, meskipun kita melihat data per jam, tujuan akhirnya adalah memprediksi pembangkitan daya AC dalam interval 15 menit yang lebih detail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_day</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">target_day</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Daily Power Generation (kW) over whole dataset&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;kW&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e894ea1fbb7dca57ec2973a427910232fbe42566004cc254464a0c5a3f1f794d.png" src="_images/e894ea1fbb7dca57ec2973a427910232fbe42566004cc254464a0c5a3f1f794d.png" />
</div>
</div>
<p>Sepertinya ada tren jangka panjang dalam pembangkitan daya, mungkin karena pola cuaca. Kita akan mencoba menambahkan beberapa fitur yang bisa menangkap hal ini dalam model kita.</p>
</section>
<section id="time-series-decomposition">
<h3>Time series decomposition<a class="headerlink" href="#time-series-decomposition" title="Link to this heading">#</a></h3>
<p>Time series decomposition adalah proses untuk memecah data deret waktu (time series) menjadi komponen-komponen yang lebih sederhana, seperti tren (trend), musiman (seasonality), dan residual (noise). Tujuan dari dekomposisi ini adalah untuk memahami pola-pola dalam data yang lebih mendalam dan memisahkan komponen-komponen tersebut agar dapat dianalisis lebih lanjut.</p>
<p>Dibawah ini <code class="docutils literal notranslate"><span class="pre">seasonal_decompose</span></code> digunakan untuk mendekomposisi target (yang dalam hal ini kemungkinan adalah data pembangkitan daya) menjadi beberapa komponen:</p>
<ol class="arabic simple">
<li><p><strong>Trend</strong>: Pola jangka panjang dalam data yang menggambarkan arah atau kecenderungan keseluruhan.</p></li>
<li><p><strong>Seasonality</strong>: Pola musiman yang berulang, seperti fluktuasi daya yang dapat dipengaruhi oleh faktor-faktor tertentu, seperti waktu dalam sehari atau perubahan cuaca.</p></li>
<li><p><strong>Residual</strong>: Sisa data yang tidak dapat dijelaskan oleh tren atau musiman, sering kali berisi noise atau fluktuasi yang tidak teratur.</p></li>
</ol>
<p>Dengan mendekomposisi data menjadi komponen-komponen ini, kita bisa mendapatkan pemahaman lebih baik tentang pola yang ada dan menggunakan informasi ini untuk meningkatkan model prediksi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_decompose</span><span class="o">=</span><span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">target</span><span class="p">,</span>
                                    <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span>
                                    <span class="n">period</span><span class="o">=</span><span class="mi">96</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span>
                                    <span class="n">two_sided</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">result_decompose</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/387f4fa0b93be06f7ee5e2f8427d393c81b9cd2e5abbeacf4f965075d357b7ef.png" src="_images/387f4fa0b93be06f7ee5e2f8427d393c81b9cd2e5abbeacf4f965075d357b7ef.png" />
</div>
</div>
<p>Dekomposisi target kita berhasil menangkap beberapa tren dengan lebih baik. Pola harian terlihat jelas seperti yang diharapkan untuk data pembangkitan daya surya. Namun, plot residual menunjukkan banyak noise yang akan sulit ditangani oleh model. Mungkin fitur-fitur lain, seperti data cuaca, dapat membantu mengurangi noise ini.</p>
<p>Sekarang kita siap untuk menentukan baseline. Baseline kita adalah menganggap bahwa pembangkitan daya pada interval 15 menit yang sama pada hari sebelumnya akan terjadi lagi pada hari yang akan datang. Kita akan menggunakan root mean squared error (RMSE) sebagai ukuran kinerja model dan menyisihkan 4 hari terakhir data untuk pengujian antar model. Dengan cara ini, kita memiliki 3 hari yang tersisa untuk bekerja karena kita memprediksi untuk satu hari ke depan. RMSE digunakan untuk memberikan penalti lebih besar pada kesalahan besar (karena kesalahan dikuadratkan dalam perhitungan). RMSE juga memberikan skor dalam satuan yang sama dengan target kita (kW). Semakin kecil skor, semakin baik modelnya.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">day</span> <span class="o">=</span> <span class="mi">96</span>
<span class="c1">#last 3 days for testing and the rest for training</span>
<span class="n">target_test</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">day</span><span class="p">:]</span>
<span class="n">target_train</span> <span class="o">=</span> <span class="n">target</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">day</span><span class="p">]</span>
<span class="c1">#moving target back a day</span>
<span class="n">baseline_preds</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">day</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">day</span><span class="p">:]</span>
<span class="n">baseline_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">target_test</span><span class="p">,</span>
                                             <span class="n">baseline_preds</span><span class="p">,</span>
                                             <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                          <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;baseline_score: &#39;</span><span class="p">,</span> <span class="n">baseline_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>baseline_score:  3699.306
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="c1"># plt.plot(X[X.index &gt; &#39;2020-06-10&#39;].index, y_pred[X.index &gt; &#39;2020-06-10&#39;], alpha=0.5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">baseline_preds</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">target_test</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Baseline RMSE Score 3-day test period: </span><span class="si">{</span><span class="n">baseline_score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Baseline preds&#39;</span><span class="p">,</span> <span class="s1">&#39;Actual&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0f8d3d977b0b1fd30caea1f6b50a0b761fbda3da8cd803f5b8caedf63acbc79f.png" src="_images/0f8d3d977b0b1fd30caea1f6b50a0b761fbda3da8cd803f5b8caedf63acbc79f.png" />
</div>
</div>
<p>Skor baseline yang dihasilkan adalah 3699 kW. Skor ini menunjukkan kesalahan rata-rata antara nilai yang diprediksi menggunakan data dari hari sebelumnya dan nilai yang sebenarnya. Meskipun tampaknya cukup tinggi, ini masih bisa dianggap sebagai hasil yang cukup baik karena dapat mencakup beberapa pola dengan cukup akurat.
Kemungkinan besar, data dari hari sebelumnya akan berperan penting dalam model kita, karena hasil baseline sudah menunjukkan adanya pola yang bisa diprediksi dari data sebelumnya.</p>
</section>
<section id="pengaruh-cuaca">
<h3>Pengaruh Cuaca<a class="headerlink" href="#pengaruh-cuaca" title="Link to this heading">#</a></h3>
<p>Selama ini, semua data dari inverter dimasukkan dalam satu kolom, dengan data setiap inverter berada di baris terpisah. Namun, untuk pemodelan, kita harus mengagregasi dataframe berdasarkan waktu dan menjadikannya sebagai index. Ini menimbulkan pertanyaan tentang bagaimana menangani data inverter. Kita bisa:</p>
<ul class="simple">
<li><p>Mengagregasi data dari semua inverter (misalnya dengan menjumlahkan daya), yang menyederhanakan dataframe, tetapi mungkin kehilangan informasi penting dari perbedaan kinerja antar inverter.</p></li>
<li><p>Memutar data inverter menjadi fitur baru di dataframe, yang akan membuat dataframe lebih kompleks tetapi memungkinkan model untuk memahami perbedaan antar inverter.</p></li>
</ul>
<p>Selain itu, kita juga akan melihat bagaimana data cuaca mempengaruhi kinerja model. Data cuaca seperti suhu dan sinar matahari bisa mempengaruhi pembangkit daya surya dan meningkatkan akurasi model jika dimasukkan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">generation</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">,</span> <span class="s1">&#39;DC_POWER&#39;</span><span class="p">,</span> <span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTAL_YIELD&#39;</span><span class="p">]</span>
<span class="n">weather</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AMBIENT_TEMPERATURE&#39;</span><span class="p">,</span> <span class="s1">&#39;MODULE_TEMPERATURE&#39;</span><span class="p">,</span> <span class="s1">&#39;IRRADIATION&#39;</span><span class="p">]</span>
<span class="n">all_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">,</span> <span class="s1">&#39;DC_POWER&#39;</span><span class="p">,</span> <span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTAL_YIELD&#39;</span><span class="p">,</span>
                <span class="s1">&#39;AMBIENT_TEMPERATURE&#39;</span><span class="p">,</span> <span class="s1">&#39;MODULE_TEMPERATURE&#39;</span><span class="p">,</span> <span class="s1">&#39;IRRADIATION&#39;</span><span class="p">]</span>
<span class="c1">#Aggregating data across inverters. We will sum the generation data and take the mean of the weather data.</span>
<span class="c1">#Also, adding back basic datetime features</span>
<span class="n">df_agg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">)[</span><span class="n">generation</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">weather</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df_agg</span><span class="p">[</span><span class="s1">&#39;HOUR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span>
<span class="n">df_agg</span><span class="p">[</span><span class="s1">&#39;DAY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span>
<span class="n">df_agg</span><span class="p">[</span><span class="s1">&#39;DAY_WEEK&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofweek</span>
<span class="n">df_agg</span><span class="p">[</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">time</span>

<span class="c1">#This maps the 15 minute intervals over the course of the day to ints 1-96.</span>
<span class="n">df_agg</span><span class="p">[</span><span class="s1">&#39;MINUTES_15&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">MINUTES_15</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="n">df_agg</span><span class="o">.</span><span class="n">MINUTES_15</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">97</span><span class="p">)})</span>
<span class="c1">#Change day of year to day of data</span>
<span class="n">df_agg</span><span class="p">[</span><span class="s1">&#39;DAY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">DAY</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="n">df_agg</span><span class="o">.</span><span class="n">DAY</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">35</span><span class="p">)})</span>
<span class="c1">#Pivoting inverter generation data as features and adding back datetime features</span>
<span class="n">inverter_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inverters</span><span class="p">:</span>
    <span class="n">df_inverter</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">INVERTER</span> <span class="o">==</span> <span class="n">i</span><span class="p">][[</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">,</span> <span class="s1">&#39;DATE_TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;AC_POWER&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;DC_POWER&#39;</span><span class="p">,</span> <span class="s1">&#39;DAILY_YIELD&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTAL_YIELD&#39;</span><span class="p">]]</span>
    <span class="n">df_inverter</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;INVERTER&#39;</span><span class="p">)</span>
    <span class="n">date_time</span> <span class="o">=</span> <span class="n">df_inverter</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;DATE_TIME&#39;</span><span class="p">)</span>
    <span class="n">df_inverter</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">date_time</span>
    <span class="n">df_inverter</span><span class="o">.</span><span class="n">columns</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">inverter_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_inverter</span><span class="p">)</span>

<span class="n">df_sep</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">inverter_dfs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_sep</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_sep</span><span class="p">,</span> <span class="n">df_agg</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">all_features_seperated</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_sep</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1">#Without the weather data</span>
<span class="n">df_agg_no_weather</span> <span class="o">=</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">weather</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_sep_no_weather</span> <span class="o">=</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">weather</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#For deep learning model</span>
<span class="n">df_agg_dl</span> <span class="o">=</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_sep_dl</span> <span class="o">=</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Pada kode diatas data pembangkit daya surya dan cuaca digabungkan dan diproses menjadi beberapa format untuk analisis lebih lanjut. Data pembangkit daya dari setiap inverter dijumlahkan (AC_POWER, DC_POWER, dll.) dan data cuaca dirata-ratakan. Fitur waktu seperti jam, hari, dan interval 15 menit juga ditambahkan. Data inverter dipisahkan menjadi fitur individu per inverter dan digabungkan dengan data agregat. Kemudian, dua versi dataframe dibuat: satu dengan data cuaca dan satu tanpa cuaca, untuk eksperimen lebih lanjut, termasuk model deep learning.</p>
</section>
</section>
<section id="model">
<h2>Model<a class="headerlink" href="#model" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#removing features (besides basic datetime ones)</span>
<span class="n">df_agg</span> <span class="o">=</span> <span class="n">df_agg_dl</span>
<span class="n">df_sep</span> <span class="o">=</span> <span class="n">df_sep_dl</span>
<span class="n">day</span> <span class="o">=</span> <span class="mi">96</span>
<span class="n">tscv</span> <span class="o">=</span> <span class="n">TimeSeriesSplit</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="n">day</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">29</span><span class="p">,</span> <span class="n">max_train_size</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">day</span><span class="p">)</span>
<span class="n">cv_indices</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#since all our inverter splits share the same index we&#39;ll just choose df_agg</span>
<span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">tscv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">4</span><span class="p">]):</span>
    <span class="n">cv_indices</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="c1">### df_sep full data including weather</span>
<span class="n">inputs_sep_trains</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">labels_sep_trains</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cv_indices</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">input_sep_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                       <span class="o">/</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">label_sep_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                       <span class="o">/</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">label_sep_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">label_sep_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">])</span>
    <span class="n">inputs_sep_trains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_sep_train</span><span class="p">)</span>
    <span class="n">labels_sep_trains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label_sep_train</span><span class="p">)</span>

<span class="n">inputs_sep_train_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">inputs_sep_trains</span><span class="p">)</span>
<span class="n">labels_sep_train_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">labels_sep_trains</span><span class="p">)</span>

<span class="n">inputs_sep_vals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">labels_sep_vals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cv_indices</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span> <span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cv_indices</span><span class="p">)):</span>
    <span class="n">input_sep_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                     <span class="o">/</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">label_sep_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                     <span class="o">/</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">label_sep_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">label_sep_val</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">])</span>
    <span class="n">inputs_sep_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_sep_val</span><span class="p">)</span>
    <span class="n">labels_sep_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label_sep_val</span><span class="p">)</span>

<span class="n">inputs_sep_val_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">inputs_sep_vals</span><span class="p">)</span>
<span class="n">labels_sep_val_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">labels_sep_vals</span><span class="p">)</span>

<span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">inputs_sep_val_stack</span><span class="p">,</span> <span class="n">labels_sep_val_stack</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Multi output sep</span>
<span class="n">MAX_EPOCHS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="n">sep_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">96</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">zeros</span><span class="p">()),</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">([</span><span class="mi">96</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="p">])</span>

<span class="n">early_stopping</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
                                                    <span class="n">patience</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span>
                                                    <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sep_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MeanSquaredError</span><span class="p">(),</span>
                <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">RootMeanSquaredError</span><span class="p">()])</span>

<span class="n">history</span> <span class="o">=</span> <span class="n">sep_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">inputs_sep_train_stack</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">labels_sep_train_stack</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">MAX_EPOCHS</span><span class="p">,</span>
                    <span class="n">validation_data</span><span class="o">=</span><span class="n">val</span><span class="p">,</span>
                    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stopping</span><span class="p">],</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">day_1_labels</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
<span class="n">day_2_labels</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">1</span><span class="p">]</span>
<span class="n">day_3_labels</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="p">:]</span>

<span class="n">test_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">day_1_labels</span><span class="p">,</span> <span class="n">day_2_labels</span><span class="p">,</span> <span class="n">day_3_labels</span><span class="p">]</span>
<span class="n">test_labels_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>

<span class="n">day_1_inputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                <span class="o">/</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">day_2_inputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                <span class="o">/</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">day_3_inputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                <span class="o">/</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">test_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">day_1_inputs</span><span class="p">,</span> <span class="n">day_2_inputs</span><span class="p">,</span> <span class="n">day_3_inputs</span><span class="p">]</span>
<span class="n">test_inputs_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">test_inputs</span><span class="p">)</span>

<span class="n">target_norm_preds</span> <span class="o">=</span> <span class="n">sep_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_inputs_stack</span><span class="p">)</span>

<span class="n">labels_preds_day_1</span> <span class="o">=</span> <span class="n">target_norm_preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> \
                     <span class="o">+</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">labels_preds_day_2</span> <span class="o">=</span> <span class="n">target_norm_preds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> \
                     <span class="o">+</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">labels_preds_day_3</span> <span class="o">=</span> <span class="n">target_norm_preds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> \
                     <span class="o">+</span> <span class="n">df_sep</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">day_1_error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="n">labels_preds_day_1</span><span class="p">,</span>
                                 <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">day_2_error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="n">labels_preds_day_2</span><span class="p">,</span>
                                 <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">day_3_error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                 <span class="n">labels_preds_day_3</span><span class="p">,</span>
                                 <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">lstm_rsme_score_test_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">day_1_error</span> <span class="o">+</span> <span class="n">day_2_error</span> <span class="o">+</span> <span class="n">day_3_error</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">labels_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">labels_preds_day_1</span><span class="p">,</span>
                               <span class="n">labels_preds_day_2</span><span class="p">,</span>
                               <span class="n">labels_preds_day_3</span><span class="p">],</span>
                              <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">test_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                              <span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                              <span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                             <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">lstm_best</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;best_score&#39;</span><span class="p">:</span><span class="n">lstm_rsme_score_test_set</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">day</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">labels_preds</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">day</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.13</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;RMSE Score test set: </span><span class="si">{</span><span class="n">lstm_rsme_score_test_set</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.13</span><span class="p">,</span> <span class="mf">.82</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Baseline Score: </span><span class="si">{</span><span class="n">baseline_score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;LSTM test set predictions vs actual: Seperated Inverters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;predicted&#39;</span><span class="p">,</span> <span class="s1">&#39;actual&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;AC Power (kW)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Day&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span> <span class=" -Color -Color-Bold">0s</span> 190ms/step
</pre></div>
</div>
<img alt="_images/5c0542526e1b82ed37c046a6ba0d075f6dd72eb0629e8d17dac74cf84ceab879.png" src="_images/5c0542526e1b82ed37c046a6ba0d075f6dd72eb0629e8d17dac74cf84ceab879.png" />
</div>
</div>
<p>Tanpa penyesuaian apapun, model ini sudah baik. Sekarang, mari kita latih dengan data inverter yang digabungkan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### df_agg full data including weather</span>
<span class="n">inputs_agg_trains</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">labels_agg_trains</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cv_indices</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">input_agg_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                        <span class="o">/</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">label_agg_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                        <span class="o">/</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">label_agg_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">label_sep_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">])</span>
    <span class="n">inputs_agg_trains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_agg_train</span><span class="p">)</span>
    <span class="n">labels_agg_trains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label_agg_train</span><span class="p">)</span>

<span class="n">inputs_agg_train_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">inputs_agg_trains</span><span class="p">)</span>
<span class="n">labels_agg_train_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">labels_agg_trains</span><span class="p">)</span>

<span class="n">inputs_agg_vals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">labels_agg_vals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cv_indices</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span> <span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cv_indices</span><span class="p">)):</span>
    <span class="n">input_agg_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                     <span class="o">/</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">label_agg_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                     <span class="o">/</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cv_indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">label_agg_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">label_sep_val</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AC_POWER&#39;</span><span class="p">])</span>
    <span class="n">inputs_agg_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_agg_val</span><span class="p">)</span>
    <span class="n">labels_agg_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label_agg_val</span><span class="p">)</span>

<span class="n">inputs_agg_val_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">inputs_agg_vals</span><span class="p">)</span>
<span class="n">labels_agg_val_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">labels_agg_vals</span><span class="p">)</span>

<span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">inputs_agg_val_stack</span><span class="p">,</span> <span class="n">labels_agg_val_stack</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Multi output agg</span>
<span class="n">MAX_EPOCHS</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="n">agg_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="c1"># Shape [batch, time, features] =&gt; [batch, lstm_units].</span>
    <span class="c1"># Adding more `lstm_units` just overfits more quickly.</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="c1"># Shape =&gt; [batch, out_steps*features].</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">96</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">zeros</span><span class="p">()),</span>
    <span class="c1"># Shape =&gt; [batch, out_steps, features].</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">([</span><span class="mi">96</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="p">])</span>

<span class="n">early_stopping</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
                                                    <span class="n">patience</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span>
                                                    <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">agg_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MeanSquaredError</span><span class="p">(),</span>
                <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">RootMeanSquaredError</span><span class="p">()])</span>

<span class="n">history</span> <span class="o">=</span> <span class="n">agg_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">inputs_agg_train_stack</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">labels_agg_train_stack</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">MAX_EPOCHS</span><span class="p">,</span>
                    <span class="n">validation_data</span><span class="o">=</span><span class="n">val</span><span class="p">,</span>
                    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stopping</span><span class="p">],</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">day_1_labels</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
<span class="n">day_2_labels</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">1</span><span class="p">]</span>
<span class="n">day_3_labels</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="p">:]</span>

<span class="n">test_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">day_1_labels</span><span class="p">,</span> <span class="n">day_2_labels</span><span class="p">,</span> <span class="n">day_3_labels</span><span class="p">]</span>
<span class="n">test_labels_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>

<span class="n">day_1_inputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                <span class="o">/</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">day_2_inputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                <span class="o">/</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">day_3_inputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> \
                <span class="o">/</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">test_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">day_1_inputs</span><span class="p">,</span> <span class="n">day_2_inputs</span><span class="p">,</span> <span class="n">day_3_inputs</span><span class="p">]</span>
<span class="n">test_inputs_stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">test_inputs</span><span class="p">)</span>

<span class="n">target_norm_preds</span> <span class="o">=</span> <span class="n">agg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_inputs_stack</span><span class="p">)</span>

<span class="n">labels_preds_day_1</span> <span class="o">=</span> <span class="n">target_norm_preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> \
                     <span class="o">+</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">labels_preds_day_2</span> <span class="o">=</span> <span class="n">target_norm_preds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> \
                     <span class="o">+</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">labels_preds_day_3</span> <span class="o">=</span> <span class="n">target_norm_preds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> \
                     <span class="o">+</span> <span class="n">df_agg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">day</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="n">day</span><span class="p">]</span><span class="o">.</span><span class="n">AC_POWER</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">day_1_error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="n">labels_preds_day_1</span><span class="p">,</span>
                                 <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">day_2_error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="n">labels_preds_day_2</span><span class="p">,</span>
                                 <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">day_3_error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                 <span class="n">labels_preds_day_3</span><span class="p">,</span>
                                 <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">lstm_rsme_score_test_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="n">day_1_error</span> <span class="o">+</span> <span class="n">day_2_error</span> <span class="o">+</span> <span class="n">day_3_error</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">labels_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">labels_preds_day_1</span><span class="p">,</span>
                               <span class="n">labels_preds_day_2</span><span class="p">,</span>
                               <span class="n">labels_preds_day_3</span><span class="p">],</span>
                              <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">test_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                              <span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                              <span class="n">test_labels_stack</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                             <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">day</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">labels_preds</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">day</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.13</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;RMSE Score test set: </span><span class="si">{</span><span class="n">lstm_rsme_score_test_set</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">best_score</span> <span class="o">=</span> <span class="n">lstm_best</span><span class="p">[</span><span class="s1">&#39;best_score&#39;</span><span class="p">]</span>
<span class="n">lstm_score_difference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lstm_rsme_score_test_set</span> <span class="o">-</span> <span class="n">best_score</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">lstm_score_difference</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.28</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">lstm_score_difference</span><span class="si">}</span><span class="s1">) New Best&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">lstm_best</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;best_score&#39;</span><span class="p">:</span> <span class="n">lstm_rsme_score_test_set</span><span class="p">})</span>
<span class="k">elif</span> <span class="p">(</span><span class="n">lstm_score_difference</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.28</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">lstm_score_difference</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="p">(</span><span class="n">lstm_score_difference</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.28</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;(+</span><span class="si">{</span><span class="n">lstm_score_difference</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.13</span><span class="p">,</span> <span class="mf">.82</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Baseline Score: </span><span class="si">{</span><span class="n">baseline_score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;LSTM test set predictions vs actual: Aggregated Inverters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;predicted&#39;</span><span class="p">,</span> <span class="s1">&#39;actual&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;AC Power (kW)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Day&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span> <span class=" -Color -Color-Bold">0s</span> 188ms/step
</pre></div>
</div>
<img alt="_images/112ce346d40fb2bab47cc682a05c02541c637e037ac1bf79e2e67698672c5898.png" src="_images/112ce346d40fb2bab47cc682a05c02541c637e037ac1bf79e2e67698672c5898.png" />
</div>
</div>
<section id="evaluasi">
<h3>Evaluasi<a class="headerlink" href="#evaluasi" title="Link to this heading">#</a></h3>
<p>Hasil RMSE menunjukkan bahwa model separated lebih baik dari pada model Aggregation</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to My Jupyter Book</p>
      </div>
    </a>
    <a class="right-next"
       href="Project%20II.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Project II</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting-multivariate"><strong>Forecasting Multivariate</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prediksi-kebutuhan-energi-panel-surya">Prediksi Kebutuhan Energi Panel Surya</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pendahuluan">Pendahuluan</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang">Latar Belakang</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rumusan-masalah">Rumusan Masalah</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan">Tujuan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bussines-understanding">Bussines Understanding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">Data Understanding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#library-yang-digunakan">Library yang digunakan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#membaca-data">Membaca data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menggabungkan-data">Menggabungkan data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">Eksplorasi Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outlier">Outlier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-value">Missing Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#target">Target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-decomposition">Time series decomposition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pengaruh-cuaca">Pengaruh Cuaca</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model">Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi">Evaluasi</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>